<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Safe Chromebook Shutdown Helper</title>
  <style>
    :root{
      --bg:#0f1724; --card:#0b1220; --accent:#6ee7b7; --muted:#9aa6b2;
      font-family:Inter,system-ui,Segoe UI,Roboto,"Helvetica Neue",Arial;
    }
    body{background:linear-gradient(180deg,#061022,#071227);color:#e6eef6;margin:0;padding:32px;display:flex;align-items:center;justify-content:center;min-height:100vh}
    .card{width:100%;max-width:820px;background:var(--card);border-radius:14px;padding:28px;box-shadow:0 8px 30px rgba(2,6,23,.6)}
    h1{margin:0 0 6px;font-size:20px}
    p.lead{margin:0 0 18px;color:var(--muted)}
    .grid{display:grid;grid-template-columns:1fr 320px;gap:18px}
    .box{background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent);padding:18px;border-radius:10px}
    button{background:var(--accent);border:0;padding:10px 12px;border-radius:8px;color:#012018;font-weight:600;cursor:pointer}
    .muted{color:var(--muted);font-size:14px}
    code{background:#051018;padding:4px 6px;border-radius:6px;color:#c8f7e6}
    .foot{margin-top:14px;color:var(--muted);font-size:13px}
    .danger{background:#3b1820;color:#ffd6d6;padding:8px;border-radius:8px}
    .hidden{display:none}
  </style>
</head>
<body>
  <div class="card" role="main">
    <h1>Safe Chromebook Shutdown Helper</h1>
    <p class="lead">A safe guide and utility page. This page <strong>cannot</strong> force your Chromebook to power off — modern browsers prevent web pages from doing system-level operations. Use the buttons below to get clear steps and tools you can click or copy.</p>

    <div class="grid">
      <div class="box">
        <h2>Detected device</h2>
        <p id="ua" class="muted">Detecting…</p>

        <h3 style="margin-top:14px">Quick safe options</h3>
        <p class="muted">Follow these first — they won't harm performance.</p>
        <ul>
          <li class="muted">Click the status tray (bottom-right) → Power / Shut down</li>
          <li class="muted">Press and hold the Chromebook power button for ~1–3s and choose Power off</li>
          <li class="muted">If the device is frozen: hold the power button for ~10s to force shutdown (last resort)</li>
        </ul>

        <div style="margin-top:12px">
          <button id="copySteps">Copy steps to clipboard</button>
          <span style="margin-left:8px" id="copied" class="muted hidden">Copied ✓</span>
        </div>

        <div style="margin-top:12px">
          <button id="tryRestart">Try restart browser (may be blocked)</button>
          <div id="restartResult" class="muted foot"></div>
        </div>

        <div style="margin-top:14px">
          <button id="downloadGuide">Download printable guide (HTML)</button>
        </div>

        <p class="foot">Note: This page is intentionally non-privileged. It only helps you perform an action you must confirm on-device.</p>
      </div>

      <div class="box">
        <h2>Guided steps for ChromeOS</h2>
        <div id="chromeosSteps" class="">
          <ol>
            <li>Click the time in the bottom-right corner to open the status tray.</li>
            <li>Click the power icon (or the <em>Power</em> / <em>Shut down</em> entry).</li>
            <li>If your screen is frozen: press and hold the power button ~10 seconds to force power off.</li>
            <li>After power off, wait 5–10s, then press the power button to turn on again.</li>
          </ol>
        </div>

        <div id="otherSteps" class="hidden">
          <p class="muted">If you're not on ChromeOS, follow your OS's normal shutdown flow (Start menu / Apple menu / system tray).</p>
        </div>

        <h3 style="margin-top:12px">Developer mode & crosh (informational)</h3>
        <p class="muted">If you're in developer mode and using the terminal (crosh) you can run commands locally — this page will not provide commands that bypass device protections. Always be cautious: developer mode reduces security.</p>

        <div style="margin-top:12px" class="danger">
          <strong>Security reminder:</strong> Web pages cannot safely or legitimately perform power operations on your device. Only use trusted local controls.
        </div>
      </div>
    </div>
  </div>

  <script>
    // Show user agent and detect ChromeOS
    const uaEl = document.getElementById('ua');
    const ua = navigator.userAgent || navigator.vendor || window.opera;
    uaEl.textContent = ua;

    const isChromeOS = /CrOS/i.test(ua) || /Chrome OS/i.test(ua) || /CrOS/.test(ua);
    document.getElementById('chromeosSteps').style.display = isChromeOS ? 'block' : 'none';
    document.getElementById('otherSteps').style.display = isChromeOS ? 'none' : 'block';

    // Copy to clipboard
    document.getElementById('copySteps').addEventListener('click', async () => {
      const text = isChromeOS
        ? `Chromebook shutdown steps:\n1) Click the time at bottom-right → Power → Shut down.\n2) Or press and hold the power button and choose Power off.\n3) If frozen, hold power ~10s to force off.`
        : `Shutdown steps for your system: use system menu or power button.`;
      try {
        await navigator.clipboard.writeText(text);
        const el = document.getElementById('copied');
        el.classList.remove('hidden');
        setTimeout(()=>el.classList.add('hidden'),2000);
      } catch(e){
        alert('Could not copy automatically. Select the text below and copy manually:\n\n'+text);
      }
    });

    // Try to restart browser (best-effort). Browsers will likely block chrome:// navigation.
    document.getElementById('tryRestart').addEventListener('click', () => {
      const out = document.getElementById('restartResult');
      out.textContent = 'Attempting to open browser restart...';
      try {
        // Some browsers block navigation to chrome://*; this is a best-effort attempt.
        location.href = 'chrome://restart';
        // If navigation is blocked, show fallback after a short timeout
        setTimeout(()=>{ out.textContent = 'If nothing happened, your browser blocked the attempt. Use the status tray or power button as instructed.'; },1200);
      } catch(err){
        out.textContent = 'Browser prevented automatic restart. Use the on-device Power menu instead.';
      }
    });

    // Download printable guide as HTML file
    document.getElementById('downloadGuide').addEventListener('click', () => {
      const guide = `
<html><head><meta charset="utf-8"><title>Shutdown Guide</title>
<style>body{font-family:Arial,Helvetica,sans-serif;margin:24px;color:#111}h1{color:#111}</style></head><body>
<h1>Chromebook Shutdown Guide</h1>
<ol>
<li>Click the time in the bottom-right corner → select Power / Shut down.</li>
<li>Or press and hold the physical power button and choose Power off.</li>
<li>If the device is completely unresponsive, hold the power button ~10 seconds to force power off (last resort).</li>
<li>Wait 5–10 seconds, then press the power button to power on.</li>
</ol>
<p>Note: This file is informational. Web pages cannot forcibly power off your device.</p>
</body></html>`;
      const blob = new Blob([guide], {type:'text/html'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'chromebook-shutdown-guide.html';
      document.body.appendChild(a);
      a.click();
      a.remove();
      setTimeout(()=>URL.revokeObjectURL(url),3000);
    });
  </script>
</body>
</html>
